# 一斉配信

## Done UI

### <code>[100%]</code> 設定 : parent?

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] タイトル
    -   [X] UTF8のみ選択可能か
    -   [X] 差出人アドレス
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [#BUG] 差出人アドレスがプルダウンに表示されるか
            -   新規作成後、別の設定を選択すると、新規作成したアドレスを選択できない. 当該formに何か入力すると、reloadされ選択可能となる
    -   [X] 返信先アドレス
    -   [X] ヘッダ / フッダテンプレート
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] プルダウンから選択したヘッダ / フッダテンプレートが適切に反映されるか
    -   [X] [埋込文字選択] ボタン押下で、埋込タグ一覧が表示されるか
    -   [X] 必須項目を入力せずに保存した場合、エラーとなり、各種エラー文言が表示されるか
-   [X] 設定一覧
    -   [X] 設定が一覧として表示されるか。各値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること
    -   [X] 基本情報、差出人、ヘッダ／フッタ押下で、開閉できるか
    -   [X] [配信先 : 配信先数] が表示されること。当該項目押下で、配信先設定画面へ遷移すること
    -   [X] [配信メール] が表示され、押下で、配信メール一覧画面へ遷移すること
    -   [X] [X] ボタン押下で、詳細画面が閉じるか
    -   [X] データ変更後、保存ボタンで変更を保存可能か
    -   [X] 詳細画面にてデータ変更された後、保存せずに他の設定を開こうとした場合、画面遷移して良いかモーダルが表示されること。
        -   [X] [はい] を選択した場合、変更は破棄され画面遷移すること。
        -   [X] [いいえ] を選択した場合、変更は破棄されず、編集中の詳細画面へ戻ること (画面外を選択し場合、いいえと同じ挙動であるか)
-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか (押下後表示される、全検索種を試行すること)
        -   [#BUG] 文字コード (検索不可だが、現状UTF8のみなので良い)
            -   自動配信では、文字コード選択可能。一斉配信のみ文字コードのリストが表示されない
        -   [X] 差出人アドレス
        -   [X] 差出人名
        -   [X] 返信先アドレス
        -   [Bug?] 配信実績 (data作成後)
            値が出てこない
        -   [X] 次回予約済時刻 (data作成後)
        -   [X] 検索フォーム (タイトル、氏名、差出人アドレス、差出人名)
            -   [#BUG] 今一動きがわからないが、そこそこ動作している
                -   [;]で全て抽出される
                -   s-numasawa+reply@ruby-dev.jpに対し[repl]でhitするが[reply]ではhit (左記、部分一致はNG。完全一致だとok)
    -   [X] 複合条件でフィルタできること (簡易)
    -   [#BUG] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        ;で全て抽出される
-   [X] pagenate (data作成後)
    -   [X] 適切にページ移動し、データが表示されるか
-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと (parent, childともに)

### <code>[100%]</code> 配信先設定

-   [X] list
    -   [X] 配信対象全てが表示されるか (アドレス帳の全員)
    -   [X] 送信対象 / 対象外が切り替え可能か (対象外は、送信されないこと)

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 氏名
        -   [X] メールアドレス
        -   [X] 種別
        -   [X] 顧客担当部門
        -   [X] 顧客ステータス
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]のみエラーとなる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか

### <code>[100%]</code> 配信メール設定 : children

-   [X] 一つの親のみに紐づき、設定が反映されること (送信時に確認)

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] 件名
    -   [X] textメール本文
    -   [X] HTMLメール本文
    -   [X] 配信日時
        -   [X] カレンダーが表示され、日付押下で適切な値が入力されるか
        -   [X] プルダウンから、00:00〜23:45間で15分間隔で設定可能か
    -   [X] 配信中止ボタンを有効/無効できるか
    -   [X] 必須項目が未入力の場合、エラーとなり、エラー文言が表示されるか
        -   [X] 現在時刻から1時間後の時刻を設定すること。反する場合、エラーとなるか

-   [X] 設定一覧
    -   [X] 各項目、値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること

-   [X] ソート、フィルタリング
    -   [X] 送信ステータスでのフィルタ
        -   [X] すべて
        -   [X] 中止
        -   [X] 送信済み
        -   [X] 未送信
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 件名
        -   [X] 日時
            -   [X] start/endが前後した場合は?
                検索結果0
        -   [X] 検索フォーム (件名)
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;] のみすべてが検索された

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか
    -   [X] [>] [<] で 1page移動されるか
    -   [X] [>>] [<<] で 末尾移動されるか

-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

## <code>[100%]</code> 文字数

-   [X] タイトル : 128
-   [X] footer / header : 65535
-   [X] subject   : 128
-   [#Bug] txt body  : 65535
    model validationはかかるが、angular側で validationかかっていない
-   [#Bug] html body : 65535
    model validationはかかるが、angular側で validationかかっていない

-   [X] html/txt bodyへ最大文字数いれて送信できるか? (sendgrid)
-   [#Bug] 各種検索フォーム / 各種フィルタフォーム
    大量の文字列入力でエラーになる

## <code>[100%]</code> 送信

-   [X] 24時間の間で、4時間区切り

## <code>[100%]</code> 本文, header, footer, subject, など

入力した内容が、保存、メールに適切に反映されるか
英数字、全角文字、xss codeなど

-   [X] header
-   [X] footer
-   [X] 本文
-   [X] subject

## <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## <code>[100%]</code> 配信停止

-   [X] 配信停止として作成
-   [X] 配信可として作成したデータを、配信停止とした場合、送信されない事
-   [X] 配信可 -> 不可 -> 可 と遷移した場合、送信される事

## <code>[100%]</code> 削除済みの設定から送信されないこと

-   [X] 作成後、即削除して試行
    送信実績がある / 関連データが作成されている場合、削除不可のため

## <code>[100%]</code> テスト送信

-   [X] 不正な address では送信できないこと
-   [X] 入力したアドレスへ送信されること
-   [X] 受信されたメールの内容が適切であること
-   [X] 配信停止アドレスの場合は?
    -   [X] 送信可能
-   [X] 送信完了済みの設定からは?
    -   [X] 送信可能
-   [X] 埋め込みタグは展開されないこと

## <code>[100%]</code> 送信対象が増減した場合

-   [X] 増
    結果、即時追加される. (UI上のreloadなど全く行わずに)

-   [X] 減
    結果、即時削除される.
    ただし、配信先一覧には残り、メールアドレスだけが削除されている状態

## <code>[100%]</code> 1userが複数の法人に所属 / 複数の事業所に所属

仕様通りの通数で送られるか?
同一メールアドレスが、複数の会社に存在する。
かつ、当該メールアドレスが、複数事業所に存在する

-   [X] 複数会社
    -   [X] 各会社1通のみ送信される
    -   [X] 埋め込みタグが適切であること
    -   [X] どこの事業所のdataが反映されるか?
        -   [X] 本店が適用された : 最初に作成されたためか?

-   [X] 複数事業所
    -   [X] 1通のみ送信される
    -   [X] 埋め込みタグが適切であること
    -   [X] どこの事業所のdataが反映されるか?
        -   [X] 本店が適用された : 最初に作成されたためか?

## <code>[100%]</code> 複数の会社が同時に送った場合

-   bb
    -   Address A (2会社/2事業所)
    -   Address B

-   追加会社1
    -   Address Z

-   [X] 適切に送信されるか
    -   [X] Address A x2
    -   [X] Address B x1
    -   [X] Address Z x1

## <code>[100%]</code> 絞り込んだ対象へ適切に送信されるか

-   [X] 送信対象
-   [X] 氏名
-   [X] メールアドレス
-   [X] 種別 | 従業員, 個人顧客, 法人顧客, 先以外
-   [X] 顧客担当部門
-   [X] 顧客ステータス

-   [X] 絞り込み + 無効にした場合、適切に動作するか

# 自動配信

## Done UI

### <code>[100%]</code> 設定

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] タイトル
    -   [X] UTF8のみ選択可能か
    -   [X] 差出人アドレス
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] 差出人アドレスがプルダウンに表示されるか
            -   新規作成後、別の設定を選択すると、新規作成したアドレスを選択できない.
    -   [X] 返信先アドレス
    -   [X] ヘッダ / フッダテンプレート
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] プルダウンから選択したヘッダ / フッダテンプレートが適切に反映されるか
    -   [X] [埋込文字選択] ボタン押下で、埋込タグ一覧が表示されるか
    -   [X] 必須項目を入力せずに保存した場合、エラーとなり、各種エラー文言が表示されるか
-   [X] 設定一覧
    -   [X] 設定が一覧として表示されるか。各値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること
    -   [X] 基本情報、差出人、ヘッダ／フッタ押下、本文設定、配信日時で、開閉できるか
    -   [X] [配信先 : 配信先数] が表示されること。当該項目押下で、配信先設定画面へ遷移すること
    -   [X] [配信メール] が表示され、押下で、配信メール一覧画面へ遷移すること
    -   [X] [X] ボタン押下で、詳細画面が閉じるか
    -   [X] データ変更後、保存ボタンで変更を保存可能か
    -   [X] 詳細画面にてデータ変更された後、保存せずに他の設定を開こうとした場合、画面遷移して良いかモーダルが表示されること。
        -   [X] [はい] を選択した場合、変更は破棄され画面遷移すること。
        -   [X] [いいえ] を選択した場合、変更は破棄されず、編集中の詳細画面へ戻ること (画面外を選択し場合、いいえと同じ挙動であるか)
    -   [X] 有効/無効を切り替えられる事
-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか (押下後表示される、全検索種を試行すること)
        -   [X] 配信状況
        -   [X] タイトル
        -   [X] 文字コード (検索不可だが、現状UTF8のみなので良い)
        -   [X] 差出人アドレス
        -   [X] 差出人名
        -   [X] 返信先アドレス
        -   [X] 検索フォーム (タイトル、差出人アドレス、差出人名、返信先アドレス)
            -   [X] 今一動きがわからないが、そこそこ動作している
                -   [;]で全て抽出される
                -   s-numasawa+reply@ruby-dev.jpに対し[repl]でhitするが[reply]ではhit (左記、部分一致はNG。完全一致だとok)
    -   [X] 複合条件でフィルタできること (簡易)
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]ではエラー、もしくは検索結果が前回のものになる
-   [X] pagenate (data作成後)
    -   [X] 適切にページ移動し、データが表示されるか
-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

### <code>[100%]</code> 配信先設定

-   [X] list
    -   [X] 配信対象全てが表示されるか
    -   [X] 送信対象 / 対象外が切り替え可能か (対象外は、送信されないこと)

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 氏名
        -   [X] メールアドレス
        -   [X] 種別
        -   [X] 顧客担当部門
        -   [X] 顧客ステータス
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]ではエラー、もしくは検索結果が前回のものになる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか

## Done 誕生日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 営業ステータス変更日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

当年及び、翌年で試行すること

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 24ヶ月前の1日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 48ヶ月後の末日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 顧客ステータス変更日

### Done ステータス

各ステータスで送信できること

-   [X] 見込み客
-   [X] 集客
-   [X] 顧客
-   [X] リビーター
-   [X] ファン
-   [X] アンバサダー

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 売上日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

    -   [X] 売上が取り消しされた場合は?
        取り消し直後から送信されなくなる

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

当年及び、翌年で試行すること

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## <code>[100%]</code> 文字数

半角 / 全角で試行

-   [X] タイトル : 128
-   [#BUG] footer / header : 65535
    全角21846文字以上でエラーとなる

-   [X] subject   : 128

-   [#BUG] txt body  : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [#BUG] html body : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [X] html/txt bodyへ最大文字数いれて送信できるか? (sendgrid)
-   [X] 各種検索フォーム / 各種フィルタフォーム
    大量の文字列入力でエラーになる

## <code>[100%]</code> 本文, header, footer, subject, など

入力した内容が、保存、メールに適切に反映されるか
英数字、全角文字、xss codeなど

-   [X] header
-   [X] footer
-   [X] 本文
-   [X] subject

## <code>[100%]</code> 有効期間外

-   [X] 有効期間外の場合、送信対象外となるか?

## <code>[100%]</code> 配信状況

-   [X] 配信無効とした場合、送信されないこと
-   [X] 配信有効 -> 無効 -> 有効 と遷移した場合、送信される事

## <code>[100%]</code> 削除済みの設定から送信されないこと

-   [X] 作成後、即削除して試行
    送信実績がある / 関連データが作成せれている場合、削除不可のため

## <code>[100%]</code> テスト送信

stagingで確認

-   [X] 不正な address では送信できないこと
-   [X] 入力したアドレスへ送信されること
-   [X] 受信されたメールの内容が適切であること
-   [X] 配信停止及び、個別アドレスが無効の場合は?
    -   [X] 送信される
-   [X] 送信完了済みの設定からは?
    -   [X] 送信される
-   [X] 埋め込みタグは展開されないこと

## <code>[100%]</code> 1userが複数の会社に所属 / 複数の事業所に所属

仕様通りの通数で送られるか?
同一メールアドレスが、複数の会社に存在する。
かつ、当該メールアドレスが、複数事業所に存在する
(2会社/2事業所)

-   [X] 誕生日 (各事業所担当者)
    -   [X] 2通 (2社の本店. 作成された順?)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 営業ステータス変更日 (各事業所に新規案件)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 売上 (各事業所に、1売上)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 顧客ステータス変更日 (各事業所に、1変更)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

## <code>[100%]</code> 複数の会社が同時に送った場合

-   bb
    -   Address A (2会社/2事業所)
-   追加会社1
    -   Address Z

-   [X] 誕生日 : 適切に送信されるか
    -   [X] Address A x2
    -   [X] Address Z x1

-   [X] 営業ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1

-   [X] 顧客ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1

-   [X] 売上日
    -   [X] Address A x4
    -   [X] Address Z x1

## <code>[100%]</code> 送信対象が増減した場合

挙動確認

-   [X] 増
    増加後、配信先で情報更新する必要あり

-   [X] 減
    更新不要

## <code>[100%]</code> 絞り込んだ対象へ適切に送信されるか

-   [X] 氏名
-   [X] メールアドレス
-   [X] 種別 | 従業員, 個人顧客, 法人顧客, 先以外
-   [X] 顧客担当部門
-   [X] 顧客ステータス

## <code>[100%]</code> 配信停止

-   [X] 配信停止URL選択後、URLフォームが開く事
-   [X] 入力したアドレスには送信されなくなる事
-   [X] 配信停止の旨、メールが届く事
-   [X] 既に配信済みのメールアドレスの場合、配信停止のお知らせが重複して送信されない事

-   [X] systemに登録の無いメールアドレスを入力した場合は?
    送信されない。配信停止した旨のpageは開く

-   [X] validation
    -   [X] 全角文字
        受け付けられる
    -   [X] mail addresのformat外
        受け付けられる
    -   [X] <script>alert(document.cookie)</script>
        特に異常は出ず

## うるう年 + 月日指定

### 誕生日

1.  Bug 2/29 誕生日 + 当日

    4年一度のみ送信された

2.  Done 2000/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

3.  Done 2001/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

4.  Done 2000/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [X] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [X] 2020/2/29
    -   [ ] 2020/3/1

5.  2001/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [未確認] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [未確認] 2020/2/29
    -   [ ] 2020/3/1

### 営業ステータス変更日

### 顧客ステータス変更日

# 一斉配信

## Done UI

### <code>[100%]</code> 設定 : parent?

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] タイトル
    -   [X] UTF8のみ選択可能か
    -   [X] 差出人アドレス
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [#BUG] 差出人アドレスがプルダウンに表示されるか
            -   新規作成後、別の設定を選択すると、新規作成したアドレスを選択できない. 当該formに何か入力すると、reloadされ選択可能となる
    -   [X] 返信先アドレス
    -   [X] ヘッダ / フッダテンプレート
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] プルダウンから選択したヘッダ / フッダテンプレートが適切に反映されるか
    -   [X] [埋込文字選択] ボタン押下で、埋込タグ一覧が表示されるか
    -   [X] 必須項目を入力せずに保存した場合、エラーとなり、各種エラー文言が表示されるか
-   [X] 設定一覧
    -   [X] 設定が一覧として表示されるか。各値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること
    -   [X] 基本情報、差出人、ヘッダ／フッタ押下で、開閉できるか
    -   [X] [配信先 : 配信先数] が表示されること。当該項目押下で、配信先設定画面へ遷移すること
    -   [X] [配信メール] が表示され、押下で、配信メール一覧画面へ遷移すること
    -   [X] [X] ボタン押下で、詳細画面が閉じるか
    -   [X] データ変更後、保存ボタンで変更を保存可能か
    -   [X] 詳細画面にてデータ変更された後、保存せずに他の設定を開こうとした場合、画面遷移して良いかモーダルが表示されること。
        -   [X] [はい] を選択した場合、変更は破棄され画面遷移すること。
        -   [X] [いいえ] を選択した場合、変更は破棄されず、編集中の詳細画面へ戻ること (画面外を選択し場合、いいえと同じ挙動であるか)
-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか (押下後表示される、全検索種を試行すること)
        -   [#BUG] 文字コード (検索不可だが、現状UTF8のみなので良い)
            -   自動配信では、文字コード選択可能。一斉配信のみ文字コードのリストが表示されない
        -   [X] 差出人アドレス
        -   [X] 差出人名
        -   [X] 返信先アドレス
        -   [Bug?] 配信実績 (data作成後)
            値が出てこない
        -   [X] 次回予約済時刻 (data作成後)
        -   [X] 検索フォーム (タイトル、氏名、差出人アドレス、差出人名)
            -   [#BUG] 今一動きがわからないが、そこそこ動作している
                -   [;]で全て抽出される
                -   s-numasawa+reply@ruby-dev.jpに対し[repl]でhitするが[reply]ではhit (左記、部分一致はNG。完全一致だとok)
    -   [X] 複合条件でフィルタできること (簡易)
    -   [#BUG] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        ;で全て抽出される
-   [X] pagenate (data作成後)
    -   [X] 適切にページ移動し、データが表示されるか
-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと (parent, childともに)

### <code>[100%]</code> 配信先設定

-   [X] list
    -   [X] 配信対象全てが表示されるか (アドレス帳の全員)
    -   [X] 送信対象 / 対象外が切り替え可能か (対象外は、送信されないこと)

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 氏名
        -   [X] メールアドレス
        -   [X] 種別
        -   [X] 顧客担当部門
        -   [X] 顧客ステータス
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]のみエラーとなる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか

### <code>[100%]</code> 配信メール設定 : children

-   [X] 一つの親のみに紐づき、設定が反映されること (送信時に確認)

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] 件名
    -   [X] textメール本文
    -   [X] HTMLメール本文
    -   [X] 配信日時
        -   [X] カレンダーが表示され、日付押下で適切な値が入力されるか
        -   [X] プルダウンから、00:00〜23:45間で15分間隔で設定可能か
    -   [X] 配信中止ボタンを有効/無効できるか
    -   [X] 必須項目が未入力の場合、エラーとなり、エラー文言が表示されるか
        -   [X] 現在時刻から1時間後の時刻を設定すること。反する場合、エラーとなるか

-   [X] 設定一覧
    -   [X] 各項目、値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること

-   [X] ソート、フィルタリング
    -   [X] 送信ステータスでのフィルタ
        -   [X] すべて
        -   [X] 中止
        -   [X] 送信済み
        -   [X] 未送信
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 件名
        -   [X] 日時
            -   [X] start/endが前後した場合は?
                検索結果0
        -   [X] 検索フォーム (件名)
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;] のみすべてが検索された

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか
    -   [X] [>] [<] で 1page移動されるか
    -   [X] [>>] [<<] で 末尾移動されるか

-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

## <code>[100%]</code> 文字数

-   [X] タイトル : 128
-   [X] footer / header : 65535
-   [X] subject   : 128
-   [#Bug] txt body  : 65535
    model validationはかかるが、angular側で validationかかっていない
-   [#Bug] html body : 65535
    model validationはかかるが、angular側で validationかかっていない

-   [X] html/txt bodyへ最大文字数いれて送信できるか? (sendgrid)
-   [#Bug] 各種検索フォーム / 各種フィルタフォーム
    大量の文字列入力でエラーになる

## <code>[100%]</code> 送信

-   [X] 24時間の間で、4時間区切り

## <code>[100%]</code> 本文, header, footer, subject, など

入力した内容が、保存、メールに適切に反映されるか
英数字、全角文字、xss codeなど

-   [X] header
-   [X] footer
-   [X] 本文
-   [X] subject

## <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## <code>[100%]</code> 配信停止

-   [X] 配信停止として作成
-   [X] 配信可として作成したデータを、配信停止とした場合、送信されない事
-   [X] 配信可 -> 不可 -> 可 と遷移した場合、送信される事

## <code>[100%]</code> 削除済みの設定から送信されないこと

-   [X] 作成後、即削除して試行
    送信実績がある / 関連データが作成されている場合、削除不可のため

## <code>[100%]</code> テスト送信

-   [X] 不正な address では送信できないこと
-   [X] 入力したアドレスへ送信されること
-   [X] 受信されたメールの内容が適切であること
-   [X] 配信停止アドレスの場合は?
    -   [X] 送信可能
-   [X] 送信完了済みの設定からは?
    -   [X] 送信可能
-   [X] 埋め込みタグは展開されないこと

## <code>[100%]</code> 送信対象が増減した場合

-   [X] 増
    結果、即時追加される. (UI上のreloadなど全く行わずに)

-   [X] 減
    結果、即時削除される.
    ただし、配信先一覧には残り、メールアドレスだけが削除されている状態

## <code>[100%]</code> 1userが複数の法人に所属 / 複数の事業所に所属

仕様通りの通数で送られるか?
同一メールアドレスが、複数の会社に存在する。
かつ、当該メールアドレスが、複数事業所に存在する

-   [X] 複数会社
    -   [X] 各会社1通のみ送信される
    -   [X] 埋め込みタグが適切であること
    -   [X] どこの事業所のdataが反映されるか?
        -   [X] 本店が適用された : 最初に作成されたためか?

-   [X] 複数事業所
    -   [X] 1通のみ送信される
    -   [X] 埋め込みタグが適切であること
    -   [X] どこの事業所のdataが反映されるか?
        -   [X] 本店が適用された : 最初に作成されたためか?

## <code>[100%]</code> 複数の会社が同時に送った場合

-   bb
    -   Address A (2会社/2事業所)
    -   Address B

-   追加会社1
    -   Address Z

-   [X] 適切に送信されるか
    -   [X] Address A x2
    -   [X] Address B x1
    -   [X] Address Z x1

## <code>[100%]</code> 絞り込んだ対象へ適切に送信されるか

-   [X] 送信対象
-   [X] 氏名
-   [X] メールアドレス
-   [X] 種別 | 従業員, 個人顧客, 法人顧客, 先以外
-   [X] 顧客担当部門
-   [X] 顧客ステータス

-   [X] 絞り込み + 無効にした場合、適切に動作するか

# 自動配信

## Done UI

### <code>[100%]</code> 設定

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] タイトル
    -   [X] UTF8のみ選択可能か
    -   [X] 差出人アドレス
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] 差出人アドレスがプルダウンに表示されるか
            -   新規作成後、別の設定を選択すると、新規作成したアドレスを選択できない.
    -   [X] 返信先アドレス
    -   [X] ヘッダ / フッダテンプレート
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] プルダウンから選択したヘッダ / フッダテンプレートが適切に反映されるか
    -   [X] [埋込文字選択] ボタン押下で、埋込タグ一覧が表示されるか
    -   [X] 必須項目を入力せずに保存した場合、エラーとなり、各種エラー文言が表示されるか
-   [X] 設定一覧
    -   [X] 設定が一覧として表示されるか。各値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること
    -   [X] 基本情報、差出人、ヘッダ／フッタ押下、本文設定、配信日時で、開閉できるか
    -   [X] [配信先 : 配信先数] が表示されること。当該項目押下で、配信先設定画面へ遷移すること
    -   [X] [配信メール] が表示され、押下で、配信メール一覧画面へ遷移すること
    -   [X] [X] ボタン押下で、詳細画面が閉じるか
    -   [X] データ変更後、保存ボタンで変更を保存可能か
    -   [X] 詳細画面にてデータ変更された後、保存せずに他の設定を開こうとした場合、画面遷移して良いかモーダルが表示されること。
        -   [X] [はい] を選択した場合、変更は破棄され画面遷移すること。
        -   [X] [いいえ] を選択した場合、変更は破棄されず、編集中の詳細画面へ戻ること (画面外を選択し場合、いいえと同じ挙動であるか)
    -   [X] 有効/無効を切り替えられる事
-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか (押下後表示される、全検索種を試行すること)
        -   [X] 配信状況
        -   [X] タイトル
        -   [X] 文字コード (検索不可だが、現状UTF8のみなので良い)
        -   [X] 差出人アドレス
        -   [X] 差出人名
        -   [X] 返信先アドレス
        -   [X] 検索フォーム (タイトル、差出人アドレス、差出人名、返信先アドレス)
            -   [X] 今一動きがわからないが、そこそこ動作している
                -   [;]で全て抽出される
                -   s-numasawa+reply@ruby-dev.jpに対し[repl]でhitするが[reply]ではhit (左記、部分一致はNG。完全一致だとok)
    -   [X] 複合条件でフィルタできること (簡易)
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]ではエラー、もしくは検索結果が前回のものになる
-   [X] pagenate (data作成後)
    -   [X] 適切にページ移動し、データが表示されるか
-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

### <code>[100%]</code> 配信先設定

-   [X] list
    -   [X] 配信対象全てが表示されるか
    -   [X] 送信対象 / 対象外が切り替え可能か (対象外は、送信されないこと)

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 氏名
        -   [X] メールアドレス
        -   [X] 種別
        -   [X] 顧客担当部門
        -   [X] 顧客ステータス
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]ではエラー、もしくは検索結果が前回のものになる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか

## Done 誕生日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 営業ステータス変更日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

当年及び、翌年で試行すること

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 24ヶ月前の1日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 48ヶ月後の末日  =>  48ヶ月, 24ヶ月の2通送信 (月指定でmm/ddが同一のため対象となる)
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 顧客ステータス変更日

### Done ステータス

各ステータスで送信できること

-   [X] 見込み客
-   [X] 集客
-   [X] 顧客
-   [X] リビーター
-   [X] ファン
-   [X] アンバサダー

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前  =>  67,31ヶ月の2通
    -   [X] 31ヶ月前  =>  67,31ヶ月の2通
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後  =>  67,31ヶ月の2通
    -   [X] 67ヶ月後  =>  67,31ヶ月の2通
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 売上日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

    -   [X] 売上が取り消しされた場合は?
        取り消し直後から送信されなくなる

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

当年及び、翌年で試行すること

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## <code>[100%]</code> 文字数

半角 / 全角で試行

-   [X] タイトル : 128
-   [#BUG] footer / header : 65535
    全角21846文字以上でエラーとなる

-   [X] subject   : 128

-   [#BUG] txt body  : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [#BUG] html body : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [X] html/txt bodyへ最大文字数いれて送信できるか? (sendgrid)
-   [X] 各種検索フォーム / 各種フィルタフォーム
    大量の文字列入力でエラーになる

## <code>[100%]</code> 本文, header, footer, subject, など

入力した内容が、保存、メールに適切に反映されるか
英数字、全角文字、xss codeなど

-   [X] header
-   [X] footer
-   [X] 本文
-   [X] subject

## <code>[100%]</code> 有効期間外

-   [X] 有効期間外の場合、送信対象外となるか?

## <code>[100%]</code> 配信状況

-   [X] 配信無効とした場合、送信されないこと
-   [X] 配信有効 -> 無効 -> 有効 と遷移した場合、送信される事

## <code>[100%]</code> 削除済みの設定から送信されないこと

-   [X] 作成後、即削除して試行
    送信実績がある / 関連データが作成せれている場合、削除不可のため

## <code>[100%]</code> テスト送信

stagingで確認

-   [X] 不正な address では送信できないこと
-   [X] 入力したアドレスへ送信されること
-   [X] 受信されたメールの内容が適切であること
-   [X] 配信停止及び、個別アドレスが無効の場合は?
    -   [X] 送信される
-   [X] 送信完了済みの設定からは?
    -   [X] 送信される
-   [X] 埋め込みタグは展開されないこと

## <code>[100%]</code> 1userが複数の会社に所属 / 複数の事業所に所属

仕様通りの通数で送られるか?
同一メールアドレスが、複数の会社に存在する。
かつ、当該メールアドレスが、複数事業所に存在する
(2会社/2事業所)

-   [X] 誕生日 (各事業所担当者)
    -   [X] 2通 (2社の本店. 作成された順?)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 営業ステータス変更日 (各事業所に新規案件)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 売上 (各事業所に、1売上)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

-   [X] 顧客ステータス変更日 (各事業所に、1変更)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)

## <code>[100%]</code> 複数の会社が同時に送った場合

-   bb
    -   Address A (2会社/2事業所)
-   追加会社1
    -   Address Z

-   [X] 誕生日 : 適切に送信されるか
    -   [X] Address A x2
    -   [X] Address Z x1

-   [X] 営業ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1

-   [X] 顧客ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1

-   [X] 売上日
    -   [X] Address A x4
    -   [X] Address Z x1

## <code>[100%]</code> 送信対象が増減した場合

挙動確認

-   [X] 増
    増加後、配信先で情報更新する必要あり

-   [X] 減
    更新不要

## <code>[100%]</code> 絞り込んだ対象へ適切に送信されるか

-   [X] 氏名
-   [X] メールアドレス
-   [X] 種別 | 従業員, 個人顧客, 法人顧客, 先以外
-   [X] 顧客担当部門
-   [X] 顧客ステータス

## <code>[100%]</code> 配信停止

-   [X] 配信停止URL選択後、URLフォームが開く事
-   [X] 入力したアドレスには送信されなくなる事
-   [X] 配信停止の旨、メールが届く事
-   [X] 既に配信済みのメールアドレスの場合、配信停止のお知らせが重複して送信されない事

-   [X] systemに登録の無いメールアドレスを入力した場合は?
    送信されない。配信停止した旨のpageは開く

-   [X] validation
    -   [X] 全角文字
        受け付けられる
    -   [X] mail addresのformat外
        受け付けられる
    -   [X] <script>alert(document.cookie)</script>
        特に異常は出ず

## Paused うるう年 + 月日指定

### 誕生日

1.  Bug 2/29 誕生日 + 当日

    4年一度のみ送信された

2.  Done 2000/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

3.  Done 2001/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

4.  Done 2000/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [X] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [X] 2020/2/29
    -   [ ] 2020/3/1

5.  Done 2001/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [未確認] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [未確認] 2020/2/29
    -   [ ] 2020/3/1

### 営業ステータス変更日

### 顧客ステータス変更日

### 売上日

# ステップ配信

## Done UI

### <code>[100%]</code> 設定 : parent?

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] タイトル
    -   [X] UTF8のみ選択可能か
    -   [X] 差出人アドレス
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] 差出人アドレスがプルダウンに表示されるか
            -   新規作成後、別の設定を選択すると、新規作成したアドレスを選択できない.
    -   [X] 返信先アドレス
    -   [X] ヘッダ / フッダテンプレート
        -   [X] 新規作成可能か
        -   [X] 必須項目がブランクの場合、エラーとなり、エラー文言が表示されるか
        -   [X] キャンセルボタンで画面が閉じるか. かつ設定は保存されないか
        -   [X] プルダウンから選択したヘッダ / フッダテンプレートが適切に反映されるか
    -   [X] [埋込文字選択] ボタン押下で、埋込タグ一覧が表示されるか
    -   [X] 必須項目を入力せずに保存した場合、エラーとなり、各種エラー文言が表示されるか
-   [X] 設定一覧
    -   [X] 設定が一覧として表示されるか。各値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること
    -   [X] 基本情報、差出人、ヘッダ／フッタ、配信タイミング押下で、開閉できるか
    -   [X] [配信先 : 配信先数] が表示されること。当該項目押下で、配信先設定画面へ遷移すること
        -   [X] [配信メール] が表示され、押下で、配信メール一覧画面へ遷移すること
    -   [X] [X] ボタン押下で、詳細画面が閉じるか
    -   [X] データ変更後、保存ボタンで変更を保存可能か
    -   [X] 詳細画面にてデータ変更された後、保存せずに他の設定を開こうとした場合、画面遷移して良いかモーダルが表示されること。
        -   [X] [はい] を選択した場合、変更は破棄され画面遷移すること。
        -   [X] [いいえ] を選択した場合、変更は破棄されず、編集中の詳細画面へ戻ること (画面外を選択し場合、いいえと同じ挙動であるか)
-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか (押下後表示される、全検索種を試行すること)
        -   [X] シナリオ名
        -   [X] 文字コード
        -   [X] 差出人アドレス
        -   [X] 差出人名
        -   [X] 返信先アドレス
        -   [X] 検索フォーム (シナリオ名、差出人アドレス、差出人名、返信先アドレス)
            -   [X] 今一動きがわからないが、そこそこ動作している
                -   [;]で全て抽出される
                -   s-numasawa+reply@ruby-dev.jpに対し[repl]でhitするが[reply]ではhit (左記、部分一致はNG。完全一致だとok)
    -   [X] 複合条件でフィルタできること (簡易)
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]のみエラーになる
-   [X] pagenate (data作成後)
    -   [X] 適切にページ移動し、データが表示されるか
-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

### <code>[100%]</code> 配信先設定

-   [X] list
    -   [X] 配信対象全てが表示されるか
    -   [X] 送信対象 / 対象外が切り替え可能か (対象外は、送信されないこと)

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 氏名
        -   [X] メールアドレス
        -   [X] 種別
        -   [X] 顧客担当部門
        -   [X] 顧客ステータス
    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]入力でエラーになる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか

### <code>[100%]</code> 配信メール設定 : children

-   [X] 一つの親のみに紐づき、設定が反映されること (送信時に確認)

-   [X] 新規作成 : 各種適切に入力、保存可能か
    -   [X] 件名
    -   [X] textメール本文
    -   [X] HTMLメール本文
    -   [X] 配信日時
        -   [X] カレンダーが表示され、日付押下で適切な値が入力されるか
        -   [X] プルダウンから、00:00〜23:45間で15分間隔で設定可能か

        -   [X] 各項目、0〜99まで入力可能である事
        -   [X] 各項目、0を入力した場合エラーになる事
        -   [#BUG?] 各項目、数値以外を入力した場合エラーになる事

        -   [X] 日付は31日まで入力可能である事
        -   [X] n月x日付指定は1〜31日以外の数値は入力不可である事
    -   [X] 配信中止ボタンを有効/無効できるか
    -   [X] 有効期間
        -   [X] 日付以外入力できない事
        -   [#BUG] start/endの日付が逆転しない事
            逆転した場合、配信対象とならない
    -   [X] 必須項目が未入力の場合、エラーとなり、エラー文言が表示されるか

-   [X] 設定一覧
    -   [X] 各項目、値が適切に表示されるか
    -   [X] 項目を選択後、詳細画面が表示されること。また、各値が適切であること

-   [X] ソート、フィルタリング
    -   [X] 項目 : 適切にフィルタリング, ソートされるか
        -   [X] 件名
        -   [#BUG] 配信時刻
            プルダウンメニューが、当該箇所ではなく、画面中央付近に表示される

    -   [X] [;] <code>[0%]</code> [<sub>]</sub> など入力し、適切に処理されるか
        [;]を入力した場合、エラーになる

-   [X] pagenate
    -   [X] 適切にページ移動し、データが表示されるか
    -   [X] [>] [<] で 1page移動されるか
    -   [X] [>>] [<<] で 末尾移動されるか

-   [X] コピー / 削除
    -   [X] ある設定をコピー可能か、また内容が適切にコピーされ保存可能か
    -   [X] ある設定を削除可能か。削除後、一覧から設定が消えるか
    -   [X] 送信実績がある場合、削除できないこと

## Done 誕生日

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 顧客ステータス変更日

### <code>[100%]</code> ステータス

各ステータスで送信できること

-   [X] 見込み客
-   [X] 集客
-   [X] 顧客
-   [X] リビーター
-   [X] ファン
-   [X] アンバサダー

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 営業ステータス変更日

### <code>[100%]</code> ステータス

各ステータスで送信できる事

-   [X] 新規
-   [X] 初回提案
-   [X] 提案中
-   [X] 最終提案
-   [X] 制約
-   [X] フォロー
-   [X] OUT/見送り

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

## Done 売上日

### <code>[100%]</code> 埋め込みタグ

業種詳細のみ、入力欄なし。

-   [X] 名 %FIRST<sub>NAME</sub>%
-   [X] 姓 %LAST<sub>NAME</sub>%
-   [X] メイ %FIRST<sub>NAME</sub><sub>KANA</sub>%
-   [X] セイ %LAST<sub>NAME</sub><sub>KANA</sub>%
-   [X] 国 %COUNTRY%
-   [X] 郵便番号    %POSTAL<sub>CODE</sub>%
-   [X] 都道府県/州 %REGION%
-   [X] 市区町村/都市 %LOCALITY%
-   [X] 番地 %STREET<sub>ADDRESS</sub>%
-   [X] 建物・番地 %EXTENDED<sub>ADDRESS</sub>%
-   [X] TEL    %PHONE%
-   [X] FAX    %FAX%
-   [X] 携帯電話    %MOBILE<sub>PHONE</sub>%
-   [X] Email    %EMAIL%

-   [X] 誕生日    %BIRTHDAY%
-   [X] 血液型    %BLOOD<sub>TYPE</sub>%

-   [X] 会社名    %COMPANY<sub>NAME</sub>%
-   [X] カイシャメイ    %COMPANY<sub>NAME</sub><sub>KANA</sub>%
-   [X] 会社名(表示名)    %COMPANY<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 代表者肩書き    %REPRESENTATIVE<sub>POSITION</sub><sub>TITLE</sub>%
-   [X] 代表者名    %REPRESENTATIVE<sub>FIRST</sub><sub>NAME</sub>%
-   [X] 代表者姓    %REPRESENTATIVE<sub>LAST</sub><sub>NAME</sub>%
-   [X] 会社URL    %COMPANY<sub>URL</sub>%
-   [X] 事業説明    %BUSINESS<sub>DESCRIPTION</sub>%

-   [#入力欄なし] 業種詳細    %BUSINESS<sub>TYPE</sub><sub>DETAIL</sub>%
-   [X] 業種    %BUSINESS<sub>TYPE</sub>%

-   [X] 本支店名    %BRANCH<sub>NAME</sub>%
-   [X] 本支店名(表示名)    %BRANCH<sub>DISPLAY</sub><sub>NAME</sub>%
-   [X] 本支店名(印刷用名称)    %BRANCH<sub>PRINTING</sub><sub>NAME</sub>%
-   [X] 本支店名(敬称)    %BRANCH<sub>HONORIFIC</sub><sub>TITLE</sub><sub>NAME</sub>%
-   [X] 本支店外部システムID    %BRANCH<sub>EXTERNAL</sub><sub>SYSTEM</sub><sub>ID</sub>%
-   [X] 本支店説明    %BRANCH<sub>DESCRIPTION</sub>%
-   [X] 本支店タグ    %BRANCH<sub>TAG</sub><sub>NAME</sub>%
-   [X] 所属    %AFFILIATION%
-   [X] 役職    %POSITION<sub>TITLE</sub>%
-   [X] 敬称    %HONORIFIC<sub>TITLE</sub><sub>NAME</sub>%
-   [X] タグ    %TAG<sub>NAME</sub>%

-   [X] 以下項目内でのみ、適切に埋込タグが展開されること
    -   [X] header
    -   [X] footer
    -   [X] text body
    -   [X] html body
    -   [X] 他項目では展開されないこと

### Done 年月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 48ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 48ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done 月日

1.  <code>[100%]</code> 日

    -   [X] 99日前
    -   [X] 50日前
    -   [X] 7日前
    -   [X] 当日
    -   [X] 7日後
    -   [X] 50日後
    -   [X] 99日後

2.  <code>[100%]</code> 週前後

    基本、日曜指定

    -   [X] 99週間前
    -   [X] 52週間前 火曜
    -   [X] 23週間前
    -   [X] 1週間前
    -   [X] 1週間後
    -   [X] 23週間後
    -   [X] 52週間後 金曜
    -   [X] 99週間後

3.  <code>[100%]</code> 月前後

    -   [X] 99ヶ月前
    -   [X] 67ヶ月前
    -   [X] 31ヶ月前
    -   [X] 1ヶ月前
    -   [X] 1ヶ月後
    -   [X] 31ヶ月後
    -   [X] 67ヶ月後
    -   [X] 99ヶ月後

4.  <code>[100%]</code> 月前後x日

    -   [X] 99ヶ月前の1日
    -   [X] 24ヶ月前の1日
    -   [X] 1ヶ月前の1日
    -   [X] 1ヶ月後の末日
    -   [X] 24ヶ月後の末日
    -   [X] 99ヶ月後の末日

5.  <code>[100%]</code> 曜日

    -   [X] 日曜
    -   [X] 月曜
    -   [X] 火曜
    -   [X] 水曜
    -   [X] 木曜
    -   [X] 金曜
    -   [X] 土曜
    -   [ ] 日曜
    -   [ ] 月曜
    -   [ ] 火曜
    -   [ ] 水曜
    -   [ ] 木曜
    -   [ ] 金曜
    -   [ ] 土曜

6.  <code>[100%]</code> 月x日

    -   [X] 1日
    -   [X] 3日
    -   [X] 7日
    -   [X] 13日
    -   [X] 19日
    -   [X] 29日
    -   [X] 31日

### Done <code>[50%]</code>取り消し / 返品の際の挙動確認

-   [X] 取り消し
    -   [X] step1
        送信されない
    -   [X] step2 (step1は既に送信済み)
        送信されない
-   [-] 返品
    エラーで返品不可

## Done update後

### Done step1がoffの場合の挙動

-   [X] step2から送信されないこと
-   [X] 既にstep1が送信されている場合、step1がoffでも後続が送信される事
-   [X] step1送信済みかつ、step2を送信する前にstep2がoffになった場合、step3から継続して送信される事.

## <code>[100%]</code> 文字数

半角 / 全角で試行

-   [X] タイトル : 128
-   [#BUG] footer / header : 65535
    全角21846文字以上でエラーとなる

-   [X] subject   : 128

-   [#BUG] txt body  : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [#BUG] html body : 65535
    model validationはかかるが、angular側で validationかかっていない
    全角21846文字以上でエラーとなる

-   [X] html/txt bodyへ最大文字数いれて送信できるか? (sendgrid)
-   [X] 各種検索フォーム / 各種フィルタフォーム
    大量の文字列入力でエラーになる

## <code>[100%]</code> 本文, header, footer, subject, など

入力した内容が、保存、メールに適切に反映されるか
英数字、全角文字、xss codeなど

-   [X] header
-   [X] footer
-   [X] 本文
-   [X] subject

## <code>[100%]</code> 配信タイミング

当日 + 下記いずれか1つのみと組み合わせて使用できること
-   [X] x日前後
-   [X] xヶ月前後
-   [X] x週前後(曜日)
-   [X] xヶ月前後 y日

## <code>[100%]</code> ステップ

-   [X] 最終まで到達した設定に、設定が追加された場合、追加ステップは送信対象とならないこと
-   [X] 同一の日付は指定できない事
-   [X] ステップ途中で、以降の文面を変えた場合、適切に反映される事

## <code>[100%]</code> 有効期間外の場合、適切に送信対象外となるか

-   [X] 有効期間外の場合、送信対象外となるか?

## <code>[100%]</code> 配信状況 (parent, child)

-   [X] parent
    -   [X] 配信無効とした場合、送信されないこと
    -   [X] 配信有効 -> 無効 -> 有効 と遷移した場合、送信される事

-   [X] child
    -   [X] 配信無効とした場合、送信されないこと
    -   [X] 配信有効 -> 無効 -> 有効 と遷移した場合、送信される事

## <code>[100%]</code> 削除済みの設定から送信されないこと

-   [X] 作成後、即削除して試行
    送信実績がある / 関連データが作成せれている場合、削除不可のため

## <code>[100%]</code> テスト送信

-   [X] 不正な address では送信できないこと
-   [X] 入力したアドレスへ送信されること
-   [X] 受信されたメールの内容が適切であること
-   [X] 配信停止アドレスの場合は?
    -   [X] 送信可能
-   [X] 送信完了済みの設定からは?
    -   [X] 送信可能
-   [X] 無効の場合は?
    -   [X] 送信可能
-   [#BUG] 各ステップで同様の動作であること
    最終ステップでエラーとなる

## <code>[100%]</code> 1userが複数の会社に所属 / 複数の事業所に所属

仕様通りの通数で送られるか?
同一メールアドレスが、複数の会社に存在する。
かつ、当該メールアドレスが、複数事業所に存在する
(2会社/2事業所)

-   [X] 誕生日 (各事業所担当者)
    -   [X] 2通 (2社の本店)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)
    -   [X] 複数ステップにおいて、上記同様の結果となるか

-   [X] 営業ステータス変更日 (各事業所に新規案件)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)
    -   [X] 複数ステップにおいて、上記同様の結果となるか

-   [X] 売上 (各事業所に、1売上)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)
    -   [X] 複数ステップにおいて、上記同様の結果となるか

-   [X] 顧客ステータス変更日 (各事業所に、1変更)
    -   [X] 4通 (各会社/各事業所宛)
    -   [X] 埋め込みタグ (各事業所のデータが適切に書き込まれるか)
    -   [X] 複数ステップにおいて、上記同様の結果となるか

## <code>[100%]</code> 複数の会社が同時に送った場合

-   bb
    -   Address A (2会社/2事業所)

-   追加会社1
    -   Address Z

-   [X] 誕生日 : 適切に送信されるか
    -   [X] Address A x2
    -   [X] Address Z x1
    -   [X] 複数ステップで同一結果となるか

-   [X] 営業ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1
    -   [X] 複数ステップで同一結果となるか

-   [X] 顧客ステータス変更日
    -   [X] Address A x4
    -   [X] Address Z x1
    -   [X] 複数ステップで同一結果となるか

-   [X] 売上日
    -   [X] Address A x4
    -   [X] Address Z x1
    -   [X] 複数ステップで同一結果となるか

## <code>[100%]</code> 送信対象が増減した場合

挙動確認

-   [X] 増
    -   [X] 各ステップでの動作
        手動でデータ更新後、追加ユーザーが反映される

    -   [X] ステップ開始時、該当とならなかった場合、対象外となる.
        途中で追加された場合は、step nから送られる事はない.

    -   [X] 途中でアドレスが変更された際は?
        変更後のアドレスになる. リロード不要

-   [X] 減
    -   [X] 各ステップでの動作
        即時反映される。リロード不要

    -   [X] 途中でユーザーが削除された場合、送信されない

    -   [X] 途中でアドレスが変更された際は?
        変更後のアドレスになる. リロード不要

## <code>[100%]</code> 絞り込んだ対象へ適切に送信されるか

-   [X] 氏名
-   [X] メールアドレス
-   [X] 種別 | 従業員, 個人顧客, 法人顧客, 先以外
-   [X] 顧客担当部門
-   [X] 顧客ステータス

-   [X] 各ステップで同一動作か
-   [X] + 加えて、送信対象外とした場合、除外されるか

## <code>[100%]</code> 配信停止

-   [X] 配信停止URL選択後、URLフォームが開く事
-   [X] 入力したアドレスには送信されなくなる事
-   [X] 配信停止の旨、メールが届く事
-   [X] 既に配信済みのメールアドレスの場合、配信停止のお知らせが重複して送信されない事

-   [X] systemに登録の無いメールアドレスを入力した場合は?
    送信されない。配信停止した旨のpageは開く

-   [X] validation check
    -   [X] 全角文字
        受け付けられる
    -   [X] mail addresのformat外
        受け付けられる
    -   [X] <script>alert(document.cookie)</script>
        特に異常は出ず

## Paused うるう年 + 月日指定

### 誕生日

1.  Bug 2/29 誕生日 + 当日

    4年一度のみ送信された

2.  Done 2000/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

3.  Done 2001/03/01 誕生日 + １日前

    送信された日付にチェック

    -   [ ] 2016/2/28
    -   [X] 2016/2/29

    -   [X] 2017/2/28
    -   [ ] 2017/2/29

    -   [X] 2018/2/28
    -   [ ] 2018/2/29

    -   [ ] 2020/2/28
    -   [X] 2020/2/29

4.  Done 2000/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [X] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [X] 2020/2/29
    -   [ ] 2020/3/1

5.  Done 2001/02/28 誕生日 + １日後

    送信された日付にチェック

    -   [未確認] 2016/2/29
    -   [ ] 2016/3/1

    -   [ ] 2017/2/29
    -   [X] 2017/3/1

    -   [ ] 2018/2/29
    -   [X] 2018/3/1

    -   [未確認] 2020/2/29
    -   [ ] 2020/3/1

### 営業ステータス変更日

### 顧客ステータス変更日

### 売上日

# 実送信テスト

## on Staging

### 送信対象

以下、計6名以外には送らない
主に、小針氏、沼沢のみに送付 ( filterが効かないので時間がかかるため)

kobari+demo2@bbank.jp
takahashi+demo2@bbank.jp
e.watanabe+demo2@bbank.jp

y-shibata+demo@ruby-dev.jp
s-numasawa+demo@ruby-dev.jp
h-sato+demo@ruby-dev.jp

### 一斉配信

1.  Done 受信

    4時間ごとに受信されている事を確認

### 自動配信

1.  Done 受信


    1.  <code>[100%]</code> 誕生日

        -   [X] 2016/07/27を共通誕生日とする。
            -   [X] 2016/07/27 15:00 # 1日ずれて届くはず (s-numasawa+demo3@ruby-dev.jp)
            -   [X] 2016/07/28 15:00 # 1日ずれて届くはず (s-numasawa+demo3@ruby-dev.jp)
            -   [X] 2016/07/29 15:00 # 1日ずれて届くはず (s-numasawa+demo3@ruby-dev.jp)

        -   [X] 小針さん, 沼沢 : 入力済みの誕生日を起点とする。(1972/6/30)
            -   [X] 2016/07/27 15:00 (27日後)
            -   [X] 2016/07/28 15:00 (28日後)
            -   [X] 2016/07/29 15:00 (29日後)

            -   [X] 2016/07/27 15:00 (n週間後の水曜日)
            -   [X] 2016/07/28 15:00 (n週間後の木曜日)
            -   [X] 2016/07/29 15:00 (n週間後の金曜日)

        -   [X] 柴田さんのみ : 入力済みの誕生日を起点とする。(1972/5/22)
            -   [X] 2016/07/27 15:00 (2ヶ月後の27日)
            -   [X] 2016/07/28 15:00 (2ヶ月後の28日)
            -   [X] 2016/07/29 15:00 (2ヶ月後の29日)

    2.  <code>[100%]</code> 顧客ステータス変更日

        小針氏、沼沢のみを対象.
        顧客となった日, 2016/07/27を変更日とする.
        2通送信 (2事業部に関連)

        -   [X] 2016/07/27 16:00
        -   [X] 2016/07/28 16:00
        -   [X] 2016/07/29 16:00

    3.  <code>[100%]</code> 営業ステータス変更日

        小針氏、沼沢のみを対象.

        -   [X] 2016/07/27に新規案件発生
            -   [X] 2016/07/27 17:00
            -   [X] 2016/07/28 17:00
            -   [X] 2016/07/29 17:00

        -   [X] 2016/06/27に新規案件発生
            -   [X] 2016/07/27 17:00 (1ヶ月後)
            -   [X] 2016/07/28 17:00 (1ヶ月後の28日)
            -   [X] 2016/07/29 17:00 (4週間後の金曜日)
                設定ミス
                追試ok 5週間後木曜 03:45

    4.  <code>[100%]</code> 売上日

        小針氏、沼沢のみを対象.

        -   [X] 2016/07/27に売上発生
            -   [X] 2016/07/27 19:00
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00

        -   [X] 2016/06/27に売上発生
            -   [X] 2016/07/27 19:00 (1ヶ月後)
            -   [X] 2016/07/28 19:00 (1ヶ月後の28日)
            -   [X] 2016/07/29 19:00 (4週間後の金曜日)

### ステップ配信

1.  受信

    1.  <code>[100%]</code> 誕生日

        -   [X] 2016/07/28を共通誕生日とする。
            -   [X] 2016/07/28を共通誕生日
                -   [X] s-numasawa+demo03@ruby-dev.jp

            -   [X] 2016/07/28 14:15
            -   [X] 2016/07/29 14:15
            -   [X] 2016/07/30 14:15

        -   [X] 小針さん, 沼沢 (1972/6/28)
            -   [X] 2016/06/28 が誕生日のユーザーを作成
                -   [X] numasawa+demo02@rub-dev.jp
                -   [X] kobari+demo03@ruby-dev.jp

            -   [X] 2016/07/28 14:00 (30日後)
            -   [X] 2016/07/29 14:00 (31日後)
            -   [X] 2016/07/30 14:00 (32日後)


            -   [X] 2016/07/29 16:30 (4週間後の金曜日)
            -   [X] 2016/07/30 16:30 (4週間後の土曜日)
            -   [X] 2016/07/31 16:30 (5週間後の日曜日)

            -   [X] 2016/07/28 14:30 (1ヶ月後)

            -   [X] 2016/07/28 14:45 (1ヶ月後の28日)
            -   [X] 2016/07/29 14:45 (1ヶ月後の29日)
            -   [X] 2016/07/30 14:45 (1ヶ月後の30日)

    2.  <code>[100%]</code> 顧客ステータス変更日

        -   [X] 元顧客, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] 集客, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] 見込客, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] 顧客, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] リピーター, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] ファン, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

        -   [X] アンバサダー, 2016/07/28を変更日
            -   [X] 2016/07/28 19:00
            -   [X] 2016/07/29 19:00
            -   [X] 2016/07/30 19:00

    3.  <code>[100%]</code> 営業ステータス変更日

        小針氏、沼沢のみを対象.

        -   [X] 新規問い合わせ : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 初回提案 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 見積書作成依頼 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 見積書提出済み : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 最終提案 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 成約 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] 長期フォロー : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] OUT : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] ベストプラクティス : 新規案件作成 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

        -   [X] ベストプラクティス : 失注 : 2016/07/28
            -   [X] 2016/07/28 19:15
            -   [X] 2016/07/29 19:15
            -   [X] 2016/07/30 19:15

    4.  <code>[100%]</code> 売上日

        小針氏、沼沢のみを対象.

        -   [X] 2016/07/29に売上 (当該日付間に有効期間を設ける)
            -   [X] 2016/07/29 15:00
            -   [X] 2016/07/30 15:00
            -   [X] 2016/07/31 15:00

        -   [X] 2016/06/29に売上
            -   [X] 2016/07/29 16:00 (1ヶ月後)

            -   [X] 2016/07/29 16:00 (1ヶ月後の29日)
            -   [X] 2016/07/30 16:00 (1ヶ月後の30日)
            -   [X] 2016/07/31 15:15 (1ヶ月後の31日)

            -   [X] 2016/07/29 16:00 (4週間後の金曜日)
            -   [X] 2016/07/30 16:00 (4週間後の土曜日)
            -   [X] 2016/07/31 16:00 (4週間後の日曜日)

### Bugs

-   staging環境のみ、配信先一覧でfilterをかけると検索結果が0になる
    切り分け結果、タグに数値があると発生する. (localにおいて再現)

## <code>[100%]</code> 文字数

sendgridから送信した場合
-   [X] header + footer + body : それぞれ65535文字入力し、送信可能
    他のBugがあるので、半角でのみ試行
-   [#BUG] subject : 128文字入力して送信可能
    全角文字の場合、100文字目付近が文字化けする